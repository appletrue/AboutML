
## 全概率公式 total probability 

回顾概率公式：(From Wiki)

假设{ Bn : n = 1, 2, 3, ... } 是一个概率空间的有限或者可数无限的分割（既 Bn为一完备事件组），且每个集合Bn是一个可测集合，则对任意事件A有全概率公式：

$Pr(A)=\sum _{n}\Pr(A\cap B_{n})\,} \Pr(A)=\sum _{{n}}\Pr(A\cap B_{n})\$,
又因为

$Pr(A\cap B_{n})=\Pr(A\mid B_{n})\Pr(B_{n}),} \Pr(A\cap B_{n})=\Pr(A\mid B_{n})\Pr(B_{n}$,
此处Pr(A | B)是B发生后A的条件概率，所以全概率公式又可写作：

$Pr(A)=\sum _{n}\Pr(A\mid B_{n})\Pr(B_{n}).\,} \Pr(A)=\sum _{{n}}\Pr(A\mid B_{n})\Pr(B_{n})$,

全概率公式将对一复杂事件A的概率求解问题转化为了在不同情况或不同原因 Bn下发生的简单事件的概率的求和问题。

（1）加法公式：P(A+B) = P(A) + P(B) - P(AB)

（2）减法公式：P(A-B) = P(A) - P(AB)

（3）乘法公式：P(AB) = P(A)*P(B|A)

（4）全概率公式 $P(A) = P(B_1)*P(A|B_1) + P(B_2)*P(A|B_2) + ........$


**全概率公式的应用**：

例1：

一批产品共8件，其中正品6件，次品2件．现不放回地从中取产品两次，每次一件，求第二次取得正品的概率．

题解：有两种写法，第一种是用组合公式，算出取的总可能，再算出第一次次品+第二次正品 和  第一次正品和第二次正品的可能性只和，相除即答案；

方法二：就是全概率公式，对于本题，A的概率只有正品和次品之分，故答案为

A2为正品的概率就是 A1为正品的概率的*（在A1为正品的前提下A2为正品的概率） + A1为次品的概率*（在A1为次品的概率下A2为正品的概率）

推广：如果是第三个为正品，那么就是A1A2为正品，A1为正品呢A2为次品，A1为次品A2为正品，A1A2为次品的概率的前提下A3为正品的概率

## 条件概率及公式

在离散情况下，上述公式等于下面这个公式。但后者在连续情况下仍然成立：

$Pr(A)=E(\Pr(A\mid N))} \Pr(A)=E(\Pr(A\mid N))$ (N是任意随机变量)。

这个公式还可以表达为：

"A的先验概率等于A的后验概率的先验期望值。


## 贝叶斯定理 Bayes'

全概率公式、贝叶斯公式推导过程

（1）条件概率公式

设A,B是两个事件，且P(B)>0,则在事件B发生的条件下，事件A发生的条件概率（conditional probability)为：

P(A|B)=P(AB)/P(B)

 （2）乘法公式

1.由条件概率公式得：

P(AB)=P(A|B)P(B)=P(B|A)P(A) (即为乘法公式)；

2.乘法公式的推广：对于任何正整数n≥2，当$P(A_1A_2...A_{n-1}) > 0$ 时，有：

$P(A_1A_2...A_{n-1}A_n)=P(A_1)P(A_2|A_1)P(A_3|A_1A_2)...P(A_n|A_1A_2...A_{n-1})$

  （3）全概率公式

1. 如果事件组B1，B2，.... 满足

1.$，B_1，B_2$....两两互斥，即 $B_i ∩ B_j = ∅ ，i≠j ， i,j=1，2$，....，且$P(B_i)>0,i=1,2$,....;

2.$B_1∪B_2∪....=Ω$ ，则称事件组 $B_1,B_2$,...是样本空间Ω的一个划分

设 $B_1,B_2$,...是样本空间Ω的一个划分，A为任一事件，则：

$P(A)=\int_{i=1}^\infty P(B_i)P(A|B_i)$ 即为全概率公式（formula of total probability)

全概率公式的意义在于，当直接计算P(A)较为困难,而P(Bi),P(A|Bi)  (i=1,2,...)的计算较为简单时，可以利用全概率公式计算P(A)。

$P(A)=P(AB_1)+P(AB_2)+....+P(AB_n)$

$=P(A|B_1)P(B_1)+P(A|B_2)P(B_2)+...+P(A|B_n)P(PB_n)$

 （4）贝叶斯公式

1. 与全概率公式解决的问题相反，贝叶斯公式是建立在条件概率的基础上寻找事件发生的原因（即大事件A已经发生的条件下，分割中的小事件Bi的概率），设B1,B2,...是样本空间Ω的一个划分，则对任一事件A（P(A)>0),有

$P(B_i|A)=\dfrac{P(B_i)P(A|B_i)}{\Sigma_{j=1}^nP(B_j)P(A|B_j)$

上式即为贝叶斯公式（Bayes formula)，Bi 常被视为导致试验结果A发生的”原因“，P(Bi)(i=1,2,...)表示各种原因发生的可能性大小，故称先验概率；P(Bi|A)(i=1,2...)则反映当试验产生了结果A之后，再对各种原因概率的新认识，故称后验概率。

2. 实例：发报台分别以概率0.6和0.4发出信号“∪”和“—”。由于通信系统受到干扰，当发出信号“∪”时，收报台分别以概率0.8和0.2受到信号“∪”和“—”；又当发出信号“—”时，收报台分别以概率0.9和0.1收到信号“—”和“∪”。求当收报台收到信号“∪”时，发报台确系发出“∪”的概率。

解：设....， P(B1|A）= (0.6*0.8)/(0.6*0.8+0.4*0.1)=0.923
